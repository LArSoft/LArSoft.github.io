<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Core Services Review - LArSoft - Fermilab Redmine</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="RY/GKiigZfPO+hTC2KR3Uj1TG9r5wK3ET7KzkbNJsY2vYSK3qD2ZhdeN+xsSSSNFVArALmI0bIA2fp3KubzuOQ==" />
<link rel='shortcut icon' href='/redmine/favicon.ico?1560171137' />
<link rel="stylesheet" media="all" href="/redmine/stylesheets/jquery/jquery-ui-1.11.0.css?1601072361" />
<link rel="stylesheet" media="all" href="/redmine/stylesheets/application.css?1601072361" />
<link rel="stylesheet" media="all" href="/redmine/stylesheets/responsive.css?1601072360" />

<script src="/redmine/javascripts/jquery-1.11.1-ui-1.11.0-ujs-3.1.4.js?1601072362"></script>
<script src="/redmine/javascripts/application.js?1601072361"></script>
<script src="/redmine/javascripts/responsive.js?1601072360"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<link rel="stylesheet" media="screen" href="/redmine/plugin_assets/redmine_countable_headers/stylesheets/countable_headers.css?1604432132" />  <script src="/redmine/plugin_assets/redmine_sortable_table/javascripts/sortable_table.js?1601318223"></script><link rel="stylesheet" media="screen" href="/redmine/plugin_assets/redmine_sortable_table/stylesheets/sortable_table.css?1601318223" /> <link rel="stylesheet" media="screen" href="/redmine/plugin_assets/redmine_group_assignee/stylesheets/tab_content_assignees.css?1604592738" />
<!-- page specific tags -->
  <script src="/redmine/javascripts/attachments.js?1601072363"></script>
</head>
<body class="project-larsoft controller-wiki action-show">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/redmine/projects/larsoft/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>

        <div class="flyout-menu__avatar flyout-menu__avatar--no-avatar">
            <a class="user active" href="/redmine/users/7">garren</a>
        </div>

        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="my-account" href="/redmine/my/account">My account</a></li><li><a class="logout" rel="nofollow" data-method="post" href="/redmine/logout">Sign out</a></li></ul>    </div>
    <div id="loggedas">Logged in as <a class="user active" href="/redmine/users/7">garren</a></div>
    <ul><li><a class="home" href="/redmine/">Home</a></li><li><a class="my-page" href="/redmine/my/page">My page</a></li><li><a class="projects" href="/redmine/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/redmine/projects/larsoft/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" value="subprojects" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/redmine/projects/larsoft/search?scope=subprojects">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">LArSoft</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/redmine/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"><a title="Accelerator Modeling" href="/redmine/projects/accelerator-modeling?jump=wiki"><span style="padding-left:0px;">Accelerator Modeling</span></a><a title="ArgoNeuT Offline" href="/redmine/projects/t962offline?jump=wiki"><span style="padding-left:0px;">ArgoNeuT Offline</span></a><a title="artdaq" href="/redmine/projects/artdaq?jump=wiki"><span style="padding-left:0px;">artdaq</span></a><a title="artdaq Demo" href="/redmine/projects/artdaq-demo?jump=wiki"><span style="padding-left:16px;">artdaq Demo</span></a><a title="artdaq Core Demo" href="/redmine/projects/artdaq-core-demo?jump=wiki"><span style="padding-left:32px;">artdaq Core Demo</span></a><a title="artdaq Utilities" href="/redmine/projects/artdaq-utilities?jump=wiki"><span style="padding-left:16px;">artdaq Utilities</span></a><a title="artdaq database" href="/redmine/projects/artdaq-database?jump=wiki"><span style="padding-left:32px;">artdaq database</span></a><a title="artdaq-mfextensions" href="/redmine/projects/mf-extensions?jump=wiki"><span style="padding-left:16px;">artdaq-mfextensions</span></a><a title="artg4" href="/redmine/projects/artg4?jump=wiki"><span style="padding-left:0px;">artg4</span></a><a title="artg4 Geant N02 example" href="/redmine/projects/artg4geantn02?jump=wiki"><span style="padding-left:16px;">artg4 Geant N02 example</span></a><a title="artg4example" href="/redmine/projects/artg4example?jump=wiki"><span style="padding-left:16px;">artg4example</span></a><a title="cet-is" href="/redmine/projects/cet-is?jump=wiki"><span style="padding-left:0px;">cet-is</span></a><a title="art" href="/redmine/projects/art?jump=wiki"><span style="padding-left:16px;">art</span></a><a title="art Hough" href="/redmine/projects/art-hough?jump=wiki"><span style="padding-left:32px;">art Hough</span></a><a title="art-workbook" href="/redmine/projects/art-workbook?jump=wiki"><span style="padding-left:32px;">art-workbook</span></a><a title="art_root_io" href="/redmine/projects/art_root_io?jump=wiki"><span style="padding-left:32px;">art_root_io</span></a><a title="artExtensions" href="/redmine/projects/artextensions?jump=wiki"><span style="padding-left:16px;">artExtensions</span></a><a title="Systematics Tools" href="/redmine/projects/systematicstools?jump=wiki"><span style="padding-left:32px;">Systematics Tools</span></a><a title="artUtilScripts" href="/redmine/projects/artutilscripts?jump=wiki"><span style="padding-left:16px;">artUtilScripts</span></a><a title="canvas" href="/redmine/projects/canvas?jump=wiki"><span style="padding-left:16px;">canvas</span></a><a title="canvas_root_io" href="/redmine/projects/canvas_root_io?jump=wiki"><span style="padding-left:32px;">canvas_root_io</span></a><a title="cet-is-private" href="/redmine/projects/cet-is-private?jump=wiki"><span style="padding-left:16px;">cet-is-private</span></a><a title="cet-is-public" href="/redmine/projects/cet-is-public?jump=wiki"><span style="padding-left:16px;">cet-is-public</span></a><a title="cetbuildtools" href="/redmine/projects/cetbuildtools?jump=wiki"><span style="padding-left:16px;">cetbuildtools</span></a><a title="cetlib" href="/redmine/projects/cetlib?jump=wiki"><span style="padding-left:16px;">cetlib</span></a><a title="cetlib_except" href="/redmine/projects/cetlib_except?jump=wiki"><span style="padding-left:32px;">cetlib_except</span></a><a title="CetModules" href="/redmine/projects/cetmodules?jump=wiki"><span style="padding-left:16px;">CetModules</span></a><a title="cetpkgsupport" href="/redmine/projects/cetpkgsupport?jump=wiki"><span style="padding-left:16px;">cetpkgsupport</span></a><a title="Chris Green&#39;s Stuff" href="/redmine/projects/cet-chg?jump=wiki"><span style="padding-left:16px;">Chris Green&#39;s Stuff</span></a><a title="CosmoSIS UPS" href="/redmine/projects/cosmosis_ups?jump=wiki"><span style="padding-left:16px;">CosmoSIS UPS</span></a><a title="cpp0x" href="/redmine/projects/cpp0x?jump=wiki"><span style="padding-left:16px;">cpp0x</span></a><a title="critic" href="/redmine/projects/critic?jump=wiki"><span style="padding-left:16px;">critic</span></a><a title="DocDB migration" href="/redmine/projects/docdb-migration?jump=wiki"><span style="padding-left:16px;">DocDB migration</span></a><a title="El Capitan Support" href="/redmine/projects/el-capitan-support?jump=wiki"><span style="padding-left:16px;">El Capitan Support</span></a><a title="fhicl" href="/redmine/projects/fhicl?jump=wiki"><span style="padding-left:16px;">fhicl</span></a><a title="fhicl-cpp" href="/redmine/projects/fhicl-cpp?jump=wiki"><span style="padding-left:32px;">fhicl-cpp</span></a><a title="fhicl-py" href="/redmine/projects/fhicl-py?jump=wiki"><span style="padding-left:32px;">fhicl-py</span></a><a title="Framework Build Instructions" href="/redmine/projects/build-framework?jump=wiki"><span style="padding-left:16px;">Framework Build Instructions</span></a><a title="hep_hpc_toolkit" href="/redmine/projects/hep_hpc_toolkit?jump=wiki"><span style="padding-left:32px;">hep_hpc_toolkit</span></a><a title="gallery" href="/redmine/projects/gallery?jump=wiki"><span style="padding-left:16px;">gallery</span></a><a title="hep_concurrency" href="/redmine/projects/hep_concurrency?jump=wiki"><span style="padding-left:16px;">hep_concurrency</span></a><a title="Lynn Garren&#39;s notes" href="/redmine/projects/lynn-garren-s-notes?jump=wiki"><span style="padding-left:16px;">Lynn Garren&#39;s notes</span></a><a title="messagefacility" href="/redmine/projects/messagefacility?jump=wiki"><span style="padding-left:16px;">messagefacility</span></a><a title="mrb" href="/redmine/projects/mrb?jump=wiki"><span style="padding-left:16px;">mrb</span></a><a title="SciSoft" href="/redmine/projects/scisoft?jump=wiki"><span style="padding-left:16px;">SciSoft</span></a><a title="Spack Planning" href="/redmine/projects/spack-planning?jump=wiki"><span style="padding-left:16px;">Spack Planning</span></a><a title="VMs and Containers" href="/redmine/projects/vms-and-containers?jump=wiki"><span style="padding-left:16px;">VMs and Containers</span></a><a title="ubuntu vm" href="/redmine/projects/ubuntu-vm?jump=wiki"><span style="padding-left:32px;">ubuntu vm</span></a><a title="cet-pythia6" href="/redmine/projects/cet-pythia6?jump=wiki"><span style="padding-left:16px;">cet-pythia6</span></a><a title="splines" href="/redmine/projects/splines?jump=wiki"><span style="padding-left:16px;">splines</span></a><a title="studio" href="/redmine/projects/studio?jump=wiki"><span style="padding-left:16px;">studio</span></a><a title="tag_suite" href="/redmine/projects/tag_suite?jump=wiki"><span style="padding-left:16px;">tag_suite</span></a><a title="art/LArSoft Course" href="/redmine/projects/art-larsoft-course?jump=wiki"><span style="padding-left:0px;">art/LArSoft Course</span></a><a title="LArIAT" href="/redmine/projects/lardbt?jump=wiki"><span style="padding-left:0px;">LArIAT</span></a><a title="LArIAT Online" href="/redmine/projects/lariat-online?jump=wiki"><span style="padding-left:16px;">LArIAT Online</span></a><a title="LArSoft" class="selected" href="/redmine/projects/larsoft?jump=wiki"><span style="padding-left:0px;">LArSoft</span></a><a title="ArgoNeuT code" href="/redmine/projects/argoneutcode?jump=wiki"><span style="padding-left:16px;">ArgoNeuT code</span></a><a title="ArgoNeuT Analysis" href="/redmine/projects/t962ana?jump=wiki"><span style="padding-left:32px;">ArgoNeuT Analysis</span></a><a title="LAr-Continuous-Integration" href="/redmine/projects/lar-ci?jump=wiki"><span style="padding-left:16px;">LAr-Continuous-Integration</span></a><a title="LAr1ND code" href="/redmine/projects/lar1ndcode?jump=wiki"><span style="padding-left:16px;">LAr1ND code</span></a><a title="LArAdmin" href="/redmine/projects/laradmin?jump=wiki"><span style="padding-left:16px;">LArAdmin</span></a><a title="LArAna" href="/redmine/projects/larana?jump=wiki"><span style="padding-left:16px;">LArAna</span></a><a title="LArCore" href="/redmine/projects/larcore?jump=wiki"><span style="padding-left:16px;">LArCore</span></a><a title="LArCoreAlg" href="/redmine/projects/larcorealg?jump=wiki"><span style="padding-left:16px;">LArCoreAlg</span></a><a title="LArCoreObj" href="/redmine/projects/larcoreobj?jump=wiki"><span style="padding-left:16px;">LArCoreObj</span></a><a title="LArData" href="/redmine/projects/lardata?jump=wiki"><span style="padding-left:16px;">LArData</span></a><a title="LArDataAlg" href="/redmine/projects/lardataalg?jump=wiki"><span style="padding-left:16px;">LArDataAlg</span></a><a title="LArDataObj" href="/redmine/projects/lardataobj?jump=wiki"><span style="padding-left:16px;">LArDataObj</span></a><a title="LArEventDisplay" href="/redmine/projects/lareventdisplay?jump=wiki"><span style="padding-left:16px;">LArEventDisplay</span></a><a title="LArEvt" href="/redmine/projects/larevt?jump=wiki"><span style="padding-left:16px;">LArEvt</span></a><a title="LArExamples" href="/redmine/projects/larexamples?jump=wiki"><span style="padding-left:16px;">LArExamples</span></a><a title="LArG4" href="/redmine/projects/larg4?jump=wiki"><span style="padding-left:16px;">LArG4</span></a><a title="larliteintegration" href="/redmine/projects/sketch?jump=wiki"><span style="padding-left:16px;">larliteintegration</span></a><a title="LArPandora" href="/redmine/projects/larpandora?jump=wiki"><span style="padding-left:16px;">LArPandora</span></a><a title="LArPandoraContent" href="/redmine/projects/larpandoracontent?jump=wiki"><span style="padding-left:16px;">LArPandoraContent</span></a><a title="LArReco" href="/redmine/projects/larreco?jump=wiki"><span style="padding-left:16px;">LArReco</span></a><a title="LArRecoDNN" href="/redmine/projects/larrecodnn?jump=wiki"><span style="padding-left:16px;">LArRecoDNN</span></a><a title="LArRelTools" href="/redmine/projects/larreltools?jump=wiki"><span style="padding-left:16px;">LArRelTools</span></a><a title="larshoweralg" href="/redmine/projects/larshoweralg?jump=wiki"><span style="padding-left:16px;">larshoweralg</span></a><a title="LArSim" href="/redmine/projects/larsim?jump=wiki"><span style="padding-left:16px;">LArSim</span></a><a title="LArSimAlg" href="/redmine/projects/larsimalg?jump=wiki"><span style="padding-left:16px;">LArSimAlg</span></a><a title="LArSimObj" href="/redmine/projects/larsimobj?jump=wiki"><span style="padding-left:16px;">LArSimObj</span></a><a title="LArSimTools" href="/redmine/projects/larsimtools?jump=wiki"><span style="padding-left:16px;">LArSimTools</span></a><a title="LArSoft-SVN (legacy site)" href="/redmine/projects/larsoftsvn?jump=wiki"><span style="padding-left:16px;">LArSoft-SVN (legacy site)</span></a><a title="LArSoft Alpha Test" href="/redmine/projects/larsoft-alpha?jump=wiki"><span style="padding-left:32px;">LArSoft Alpha Test</span></a><a title="LArSoft Experiments Alpha Test" href="/redmine/projects/larsoft-experiment-alpha?jump=wiki"><span style="padding-left:48px;">LArSoft Experiments Alpha Test</span></a><a title="LArSoftObj" href="/redmine/projects/larsoftobj?jump=wiki"><span style="padding-left:16px;">LArSoftObj</span></a><a title="LArSystematics" href="/redmine/projects/larsystematics?jump=wiki"><span style="padding-left:16px;">LArSystematics</span></a><a title="LArTestAlg" href="/redmine/projects/lartestalg?jump=wiki"><span style="padding-left:16px;">LArTestAlg</span></a><a title="LArToolObj" href="/redmine/projects/lartoolobj?jump=wiki"><span style="padding-left:16px;">LArToolObj</span></a><a title="LArUtils" href="/redmine/projects/larutils?jump=wiki"><span style="padding-left:16px;">LArUtils</span></a><a title="larwirecell" href="/redmine/projects/larwirecell?jump=wiki"><span style="padding-left:16px;">larwirecell</span></a><a title="LBNE code" href="/redmine/projects/lbnecode?jump=wiki"><span style="padding-left:16px;">LBNE code</span></a><a title="NuSystematics" href="/redmine/projects/nusystematics?jump=wiki"><span style="padding-left:16px;">NuSystematics</span></a><a title="parsegdml" href="/redmine/projects/parsegdml?jump=wiki"><span style="padding-left:16px;">parsegdml</span></a><a title="uBooNE code" href="/redmine/projects/uboonecode?jump=wiki"><span style="padding-left:16px;">uBooNE code</span></a><a title="CC1pi" href="/redmine/projects/cc1pi?jump=wiki"><span style="padding-left:32px;">CC1pi</span></a><a title="UBooNE alg" href="/redmine/projects/uboonealg?jump=wiki"><span style="padding-left:32px;">UBooNE alg</span></a><a title="uBAna" href="/redmine/projects/ubana?jump=wiki"><span style="padding-left:32px;">uBAna</span></a><a title="uBCRT" href="/redmine/projects/ubcrt?jump=wiki"><span style="padding-left:32px;">uBCRT</span></a><a title="uBCV" href="/redmine/projects/ubcv?jump=wiki"><span style="padding-left:32px;">uBCV</span></a><a title="uBCore" href="/redmine/projects/ubcore?jump=wiki"><span style="padding-left:32px;">uBCore</span></a><a title="uBEvt" href="/redmine/projects/ubevt?jump=wiki"><span style="padding-left:32px;">uBEvt</span></a><a title="uBLite" href="/redmine/projects/ublite?jump=wiki"><span style="padding-left:32px;">uBLite</span></a><a title="uBObj" href="/redmine/projects/ubobj?jump=wiki"><span style="padding-left:32px;">uBObj</span></a><a title="uBRaw" href="/redmine/projects/ubraw?jump=wiki"><span style="padding-left:32px;">uBRaw</span></a><a title="uBReco" href="/redmine/projects/ubreco?jump=wiki"><span style="padding-left:32px;">uBReco</span></a><a title="uBSim" href="/redmine/projects/ubsim?jump=wiki"><span style="padding-left:32px;">uBSim</span></a><a title="uBXSec" href="/redmine/projects/ubxsec?jump=wiki"><span style="padding-left:32px;">uBXSec</span></a><a title="lar_ci" href="/redmine/projects/lar_ci?jump=wiki"><span style="padding-left:0px;">lar_ci</span></a><a title="darkart" href="/redmine/projects/darkart?jump=wiki"><span style="padding-left:0px;">darkart</span></a><a title="darkmon" href="/redmine/projects/darkmon?jump=wiki"><span style="padding-left:0px;">darkmon</span></a><a title="darkside-public" href="/redmine/projects/darkside-public?jump=wiki"><span style="padding-left:0px;">darkside-public</span></a><a title="darksidecore" href="/redmine/projects/darksidecore?jump=wiki"><span style="padding-left:0px;">darksidecore</span></a><a title="ds50daq" href="/redmine/projects/ds50daq?jump=wiki"><span style="padding-left:0px;">ds50daq</span></a><a title="DUNE" href="/redmine/projects/dune?jump=wiki"><span style="padding-left:0px;">DUNE</span></a><a title="DUNE Approved Plots" href="/redmine/projects/dune-approved-plots?jump=wiki"><span style="padding-left:16px;">DUNE Approved Plots</span></a><a title="Dune Computing" href="/redmine/projects/dune-computing?jump=wiki"><span style="padding-left:16px;">Dune Computing</span></a><a title="duneutil" href="/redmine/projects/duneutil?jump=wiki"><span style="padding-left:32px;">duneutil</span></a><a title="DUNE DAQ" href="/redmine/projects/dune-daq?jump=wiki"><span style="padding-left:16px;">DUNE DAQ</span></a><a title="DUNE NearDet Design" href="/redmine/projects/dune-neardet-design?jump=wiki"><span style="padding-left:16px;">DUNE NearDet Design</span></a><a title="dunetpc" href="/redmine/projects/dunetpc?jump=wiki"><span style="padding-left:16px;">dunetpc</span></a><a title="protoduneana" href="/redmine/projects/protoduneana?jump=wiki"><span style="padding-left:32px;">protoduneana</span></a><a title="upd" href="/redmine/projects/upd?jump=wiki"><span style="padding-left:0px;">upd</span></a><a title="ups" href="/redmine/projects/ups?jump=wiki"><span style="padding-left:0px;">ups</span></a><a title="Fermi Redmine" href="/redmine/projects/fermi-redmine?jump=wiki"><span style="padding-left:0px;">Fermi Redmine</span></a><a title="Projects for Monitoring Redmine Health" href="/redmine/projects/test-p1?jump=wiki"><span style="padding-left:16px;">Projects for Monitoring Redmine Health</span></a><a title="redmine-lib" href="/redmine/projects/redmine-lib?jump=wiki"><span style="padding-left:16px;">redmine-lib</span></a><a title="g4hpc" href="/redmine/projects/g4hpc?jump=wiki"><span style="padding-left:0px;">g4hpc</span></a><a title="g4hpcbenchmarks" href="/redmine/projects/g4hpcbenchmarks?jump=wiki"><span style="padding-left:16px;">g4hpcbenchmarks</span></a><a title="HepPDT" href="/redmine/projects/heppdt?jump=wiki"><span style="padding-left:0px;">HepPDT</span></a><a title="ICARUS LArSoft" href="/redmine/projects/icaruscode?jump=wiki"><span style="padding-left:0px;">ICARUS LArSoft</span></a><a title="icarus_data" href="/redmine/projects/icarus_data?jump=wiki"><span style="padding-left:16px;">icarus_data</span></a><a title="icarusutil" href="/redmine/projects/icarusutil?jump=wiki"><span style="padding-left:16px;">icarusutil</span></a><a title="LAr Batch Tools" href="/redmine/projects/larbatch?jump=wiki"><span style="padding-left:0px;">LAr Batch Tools</span></a><a title="LBNE Utilities" href="/redmine/projects/lbneutil?jump=wiki"><span style="padding-left:0px;">LBNE Utilities</span></a><a title="DAQ" href="/redmine/projects/mu2edaq?jump=wiki"><span style="padding-left:0px;">DAQ</span></a><a title="mu2e_artdaq" href="/redmine/projects/mu2e_artdaq?jump=wiki"><span style="padding-left:16px;">mu2e_artdaq</span></a><a title="Mu2e DAQ Computing" href="/redmine/projects/mu2e-daq-computing?jump=wiki"><span style="padding-left:16px;">Mu2e DAQ Computing</span></a><a title="mu2e DCS" href="/redmine/projects/mu2e-dcs?jump=wiki"><span style="padding-left:16px;">mu2e DCS</span></a><a title="Mu2e Raw Data" href="/redmine/projects/mu2e-raw-data?jump=wiki"><span style="padding-left:16px;">Mu2e Raw Data</span></a><a title="Databases" href="/redmine/projects/databases?jump=wiki"><span style="padding-left:0px;">Databases</span></a><a title="Detector Construction DB" href="/redmine/projects/mu2e_detector_construction_db?jump=wiki"><span style="padding-left:16px;">Detector Construction DB</span></a><a title="Offline Software" href="/redmine/projects/offlinesoftware?jump=wiki"><span style="padding-left:0px;">Offline Software</span></a><a title="G4beamline" href="/redmine/projects/mu2eofflinesoftwareg4beamline?jump=wiki"><span style="padding-left:16px;">G4beamline</span></a><a title="Grid Scripts" href="/redmine/projects/mu2egrid?jump=wiki"><span style="padding-left:16px;">Grid Scripts</span></a><a title="Muon g-2" href="/redmine/projects/g-2?jump=wiki"><span style="padding-left:0px;">Muon g-2</span></a><a title="Calorimeter CDR req." href="/redmine/projects/calorequirements?jump=wiki"><span style="padding-left:16px;">Calorimeter CDR req.</span></a><a title="g-2 Art Examples" href="/redmine/projects/gm2artexamples?jump=wiki"><span style="padding-left:16px;">g-2 Art Examples</span></a><a title="g-2 CDR" href="/redmine/projects/gm2cdr?jump=wiki"><span style="padding-left:16px;">g-2 CDR</span></a><a title="g-2 DAQ" href="/redmine/projects/gm2daq?jump=wiki"><span style="padding-left:16px;">g-2 DAQ</span></a><a title="g-2 DQM" href="/redmine/projects/gm2dqm?jump=wiki"><span style="padding-left:32px;">g-2 DQM</span></a><a title="g-2 public" href="/redmine/projects/gm2public?jump=wiki"><span style="padding-left:16px;">g-2 public</span></a><a title="g-2 Release Tools" href="/redmine/projects/gm2releasetools?jump=wiki"><span style="padding-left:16px;">g-2 Release Tools</span></a><a title="g2MIGTRACE" href="/redmine/projects/g2migtrace?jump=wiki"><span style="padding-left:16px;">g2MIGTRACE</span></a><a title="g2mtanalysismacros" href="/redmine/projects/g2mtanalysismacros?jump=wiki"><span style="padding-left:16px;">g2mtanalysismacros</span></a><a title="g-2 SRBD" href="/redmine/projects/g-2-srbd?jump=wiki"><span style="padding-left:16px;">g-2 SRBD</span></a><a title="g-2 TDR" href="/redmine/projects/gm2tdr?jump=wiki"><span style="padding-left:16px;">g-2 TDR</span></a><a title="gm2analyses" href="/redmine/projects/gm2analyses?jump=wiki"><span style="padding-left:16px;">gm2analyses</span></a><a title="gm2aux" href="/redmine/projects/gm2aux?jump=wiki"><span style="padding-left:16px;">gm2aux</span></a><a title="gm2beams" href="/redmine/projects/gm2beams?jump=wiki"><span style="padding-left:16px;">gm2beams</span></a><a title="gm2calo" href="/redmine/projects/gm2calo?jump=wiki"><span style="padding-left:16px;">gm2calo</span></a><a title="gm2dataproducts" href="/redmine/projects/gm2dataproducts?jump=wiki"><span style="padding-left:16px;">gm2dataproducts</span></a><a title="gm2field" href="/redmine/projects/gm2field?jump=wiki"><span style="padding-left:16px;">gm2field</span></a><a title="gm2fieldanalyzer" href="/redmine/projects/gm2fieldanalyzer?jump=wiki"><span style="padding-left:32px;">gm2fieldanalyzer</span></a><a title="gm2fielddaq" href="/redmine/projects/gm2fielddaq?jump=wiki"><span style="padding-left:32px;">gm2fielddaq</span></a><a title="gm2fieldsignal" href="/redmine/projects/gm2fieldsignal?jump=wiki"><span style="padding-left:32px;">gm2fieldsignal</span></a><a title="gm2geom" href="/redmine/projects/gm2geom?jump=wiki"><span style="padding-left:16px;">gm2geom</span></a><a title="gm2mcdataproducts" href="/redmine/projects/gm2mcdataproducts?jump=wiki"><span style="padding-left:16px;">gm2mcdataproducts</span></a><a title="gm2midas" href="/redmine/projects/gm2midas?jump=wiki"><span style="padding-left:16px;">gm2midas</span></a><a title="gm2midastoart" href="/redmine/projects/gm2midastoart?jump=wiki"><span style="padding-left:16px;">gm2midastoart</span></a><a title="gm2MTest2012" href="/redmine/projects/gm2mtest2012?jump=wiki"><span style="padding-left:16px;">gm2MTest2012</span></a><a title="gm2optics" href="/redmine/projects/gm2optics?jump=wiki"><span style="padding-left:16px;">gm2optics</span></a><a title="gm2planning" href="/redmine/projects/gm2planning?jump=wiki"><span style="padding-left:16px;">gm2planning</span></a><a title="gm2reconeast" href="/redmine/projects/gm2reconeast?jump=wiki"><span style="padding-left:16px;">gm2reconeast</span></a><a title="gm2ringsim" href="/redmine/projects/gm2ringsim?jump=wiki"><span style="padding-left:16px;">gm2ringsim</span></a><a title="gm2SoftwareTools" href="/redmine/projects/gm2softwaretools?jump=wiki"><span style="padding-left:16px;">gm2SoftwareTools</span></a><a title="gm2strawtracking" href="/redmine/projects/gm2strawtracking?jump=wiki"><span style="padding-left:16px;">gm2strawtracking</span></a><a title="gm2swdocs" href="/redmine/projects/gm2swdocs?jump=wiki"><span style="padding-left:16px;">gm2swdocs</span></a><a title="gm2test" href="/redmine/projects/gm2test?jump=wiki"><span style="padding-left:16px;">gm2test</span></a><a title="gm2tracker" href="/redmine/projects/gm2tracker?jump=wiki"><span style="padding-left:16px;">gm2tracker</span></a><a title="gm2trackerdaq" href="/redmine/projects/gm2trackerdaq?jump=wiki"><span style="padding-left:16px;">gm2trackerdaq</span></a><a title="gm2unpackers" href="/redmine/projects/gm2unpackers?jump=wiki"><span style="padding-left:16px;">gm2unpackers</span></a><a title="gm2util" href="/redmine/projects/gm2util?jump=wiki"><span style="padding-left:16px;">gm2util</span></a><a title="gm2viz" href="/redmine/projects/gm2viz?jump=wiki"><span style="padding-left:16px;">gm2viz</span></a><a title="gm2vtk" href="/redmine/projects/gm2vtk?jump=wiki"><span style="padding-left:16px;">gm2vtk</span></a><a title="g-2 Field Shimming Paper" href="/redmine/projects/gm2fsp?jump=wiki"><span style="padding-left:16px;">g-2 Field Shimming Paper</span></a><a title="gm2db" href="/redmine/projects/gm2db?jump=wiki"><span style="padding-left:16px;">gm2db</span></a><a title="gm2ilratio" href="/redmine/projects/gm2ilratio?jump=wiki"><span style="padding-left:16px;">gm2ilratio</span></a><a title="gm2reconita" href="/redmine/projects/gm2reconita?jump=wiki"><span style="padding-left:16px;">gm2reconita</span></a><a title="gm2sc" href="/redmine/projects/gm2sc?jump=wiki"><span style="padding-left:16px;">gm2sc</span></a><a title="gm2simvalidation" href="/redmine/projects/gm2simvalidation?jump=wiki"><span style="padding-left:16px;">gm2simvalidation</span></a><a title="gm2templates" href="/redmine/projects/gm2templates?jump=wiki"><span style="padding-left:16px;">gm2templates</span></a><a title="NOvA-ART" href="/redmine/projects/novaart?jump=wiki"><span style="padding-left:0px;">NOvA-ART</span></a><a title="NOvA validation" href="/redmine/projects/nova-validation?jump=wiki"><span style="padding-left:16px;">NOvA validation</span></a><a title="NuTools" href="/redmine/projects/nutools?jump=wiki"><span style="padding-left:0px;">NuTools</span></a><a title="NuEvdb" href="/redmine/projects/nuevdb?jump=wiki"><span style="padding-left:16px;">NuEvdb</span></a><a title="NuG4" href="/redmine/projects/nug4?jump=wiki"><span style="padding-left:16px;">NuG4</span></a><a title="NuGen" href="/redmine/projects/nugen?jump=wiki"><span style="padding-left:16px;">NuGen</span></a><a title="NuRandom" href="/redmine/projects/nurandom?jump=wiki"><span style="padding-left:16px;">NuRandom</span></a><a title="NuSimData" href="/redmine/projects/nusimdata?jump=wiki"><span style="padding-left:16px;">NuSimData</span></a><a title="NuSoft/NuTools" href="/redmine/projects/nusoftart?jump=wiki"><span style="padding-left:16px;">NuSoft/NuTools</span></a><a title="PPFX" href="/redmine/projects/ppfx?jump=wiki"><span style="padding-left:16px;">PPFX</span></a><a title="OSG-Geant4-OSGMM" href="/redmine/projects/osg-geant4-osgmm?jump=wiki"><span style="padding-left:0px;">OSG-Geant4-OSGMM</span></a><a title="SBND code" href="/redmine/projects/sbndcode?jump=wiki"><span style="padding-left:0px;">SBND code</span></a><a title="SBND utility scripts" href="/redmine/projects/sbndutil?jump=wiki"><span style="padding-left:0px;">SBND utility scripts</span></a><a title="IF Data Handling Client Tools (ifdhc)" href="/redmine/projects/ifdhc?jump=wiki"><span style="padding-left:0px;">IF Data Handling Client Tools (ifdhc)</span></a><a title="IFDH Art interface" href="/redmine/projects/ifdh-art?jump=wiki"><span style="padding-left:16px;">IFDH Art interface</span></a><a title="Simulation Tools and Features" href="/redmine/projects/stf?jump=wiki"><span style="padding-left:0px;">Simulation Tools and Features</span></a><a title="artg4tk" href="/redmine/projects/artg4tk?jump=wiki"><span style="padding-left:16px;">artg4tk</span></a><a title="DoSSiER" href="/redmine/projects/dossier?jump=wiki"><span style="padding-left:16px;">DoSSiER</span></a><a title="Geant4Reweight" href="/redmine/projects/geant4reweight?jump=wiki"><span style="padding-left:16px;">Geant4Reweight</span></a><a title="uBooNE Reconstruction" href="/redmine/projects/uboone-reconstruction?jump=wiki"><span style="padding-left:0px;">uBooNE Reconstruction</span></a><a title="uBooNE Utilities" href="/redmine/projects/ubutil?jump=wiki"><span style="padding-left:0px;">uBooNE Utilities</span></a><a title="detsim.fnal.gov" href="/redmine/projects/detsim-fnal-gov?jump=wiki"><span style="padding-left:0px;">detsim.fnal.gov</span></a><a title="SoftRelTools" href="/redmine/projects/softreltools?jump=wiki"><span style="padding-left:0px;">SoftRelTools</span></a><a title="Spack Infrastructure" href="/redmine/projects/spack-infrastructure?jump=wiki"><span style="padding-left:0px;">Spack Infrastructure</span></a></div><div class="drdn-items all-projects selection"><a href="/redmine/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">LArSoft</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li>
<a id="new-object" onclick="toggleNewObjectDropdown(); return false;" class="new-object" href="#"> + </a>
<ul class="menu-children"><li><a accesskey="7" class="new-issue-sub" href="/redmine/projects/larsoft/issues/new">New issue</a></li><li><a class="new-issue-category" href="/redmine/projects/larsoft/issue_categories/new">New category</a></li><li><a class="new-version" href="/redmine/projects/larsoft/versions/new">New version</a></li><li><a class="new-timelog" href="/redmine/projects/larsoft/time_entries/new">Log time</a></li><li><a class="new-document" href="/redmine/projects/larsoft/documents/new">New document</a></li><li><a class="new-wiki-page" href="/redmine/projects/larsoft/wiki/new">New wiki page</a></li><li><a class="new-file" href="/redmine/projects/larsoft/files/new">New file</a></li></ul>
</li><li><a class="overview" href="/redmine/projects/larsoft">Overview</a></li><li><a class="activity" href="/redmine/projects/larsoft/activity">Activity</a></li><li><a class="roadmap" href="/redmine/projects/larsoft/roadmap">Roadmap</a></li><li><a class="issues" href="/redmine/projects/larsoft/issues">Issues</a></li><li><a class="time-entries" href="/redmine/projects/larsoft/time_entries">Spent time</a></li><li><a class="gantt" href="/redmine/projects/larsoft/issues/gantt">Gantt</a></li><li><a class="calendar" href="/redmine/projects/larsoft/issues/calendar">Calendar</a></li><li><a class="documents" href="/redmine/projects/larsoft/documents">Documents</a></li><li><a class="wiki selected" href="/redmine/projects/larsoft/wiki">Wiki</a></li><li><a class="files" href="/redmine/projects/larsoft/files">Files</a></li><li><a class="repository" href="/redmine/projects/larsoft/repository">Repository</a></li><li><a class="settings" href="/redmine/projects/larsoft/settings">Settings</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          
<h3>Wiki</h3>
<ul>
  <li><a href="/redmine/projects/larsoft/wiki">Start page</a></li>
  <li><a href="/redmine/projects/larsoft/wiki/index">Index by title</a></li>
  <li><a href="/redmine/projects/larsoft/wiki/date_index">Index by date</a></li>
</ul>


        
    </div>

    <div id="content">
        
        <div class="contextual">
<a class="icon icon-add" data-remote="true" href="/redmine/projects/larsoft/wiki/new">New wiki page</a>
  <a class="icon icon-edit" accesskey="e" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit">Edit</a>
  <a class="wiki_page-17606-watcher icon icon-fav-off" data-remote="true" rel="nofollow" data-method="post" href="/redmine/watchers/watch?object_id=17606&amp;object_type=wiki_page">Watch</a>
  <a class="icon icon-lock" rel="nofollow" data-method="post" href="/redmine/projects/larsoft/wiki/Core_Services_Review/protect?protected=1">Lock</a>
  
  <a class="icon icon-move" href="/redmine/projects/larsoft/wiki/Core_Services_Review/rename">Rename</a>
  <a data-confirm="Are you sure?" class="icon icon-del" rel="nofollow" data-method="delete" href="/redmine/projects/larsoft/wiki/Core_Services_Review">Delete</a>
<a class="icon icon-history" href="/redmine/projects/larsoft/wiki/Core_Services_Review/history">History</a>
</div>

<p class="breadcrumb"><a href="/redmine/projects/larsoft/wiki/LArSoftWiki">LArSoftWiki</a> » <a href="/redmine/projects/larsoft/wiki/Developing_With_LArSoft">Developing With LArSoft</a> » <a href="/redmine/projects/larsoft/wiki/Package_Documentation">Package Documentation</a> » <a href="/redmine/projects/larsoft/wiki/RecoBase">RecoBase</a> » <a href="/redmine/projects/larsoft/wiki/Architecture_revision">Architecture revision</a> » </p>


<div class="wiki wiki-page">
  <a name="The-new-core-services"></a>
<h1 >The new core services<a href="#The-new-core-services" class="wiki-anchor">&para;</a></h1>


	<ul class="toc right"><li><strong>Table of contents</strong></li><li><a href="#The-new-core-services">The new core services</a><ul><li><a href="#New-service-access-pattern">New service access pattern</a><ul><li><a href="#How-to-update-to-the-new-service-access-pattern">How to update to the new service access pattern</a><ul><li><a href="#If-your-code-declares-and-uses-a-local-service-handle">If your code declares and uses a local service handle...</a></li><li><a href="#If-your-code-uses-a-service-pointer-or-reference">If your code uses a service pointer or reference...</a></li><li><a href="#If-your-algorithm-class-has-a-service-handle-member">If your algorithm class has a service handle member...</a></li></ul>
</li></ul>
</li><li><a href="#Renamed-services">Renamed services</a><ul><li><a href="#Examples-of-update-DetectorProperties-service">Examples of update: DetectorProperties service</a></li><li><a href="#Examples-of-update-TimeService-service">Examples of update: TimeService service</a></li><li><a href="#Examples-of-update-Geometry-service">Examples of update: Geometry service</a></li><li><a href="#Additional-steps-for-updating-DetectorPropertiesService-and-LArPropertiesService">Additional steps for updating DetectorPropertiesService and LArPropertiesService</a></li></ul>
</li><li><a href="#Core-service-dependencies">Core service dependencies</a></li><li><a href="#Core-services-turned-into-service-interfaces">Core services turned into service interfaces</a></li><li><a href="#New-namespaces">New namespaces</a></li><li><a href="#Functions-and-configuration-parameters-moved-from-one-service-to-another">Functions and configuration parameters moved from one service to another</a><ul><li><a href="#FHiCL-parameter-validation-for-detutilLArPropertiesStandard-and-detutilDetectorPropertiesStandard">FHiCL parameter validation for detutil::LArPropertiesStandard and detutil::DetectorPropertiesStandard</a></li></ul>
</li><li><a href="#Summary-of-update-steps">Summary of update steps</a><ul><li><a href="#Helper-script">Helper script</a></li></ul>
</li><li><a href="#The-ProviderPack-and-ServicePack-classes">The ProviderPack and ServicePack classes</a></li></ul></li></ul>


	<p>LArSoft architecture review on 2015 affected most of the "core" services.<br />Main changes are summarized in the table of contents:</p>


	<div class="contextual heading-2" title="Edit this section" id="section-2"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=2">Edit this section</a></div><a name="New-service-access-pattern"></a>
<h2 >New service access pattern<a href="#New-service-access-pattern" class="wiki-anchor">&para;</a></h2>


	<p><strong>The old pattern</strong>: use the service directly, e.g.:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">art::ServiceHandle&lt;util::DetectorProperties&gt; detprop;
<span class="predefined-type">double</span> sampling_rate = detprop-&gt;SamplingRate();
</span></code></pre></p>


	<p><strong>The new pattern</strong>: obtain the service provider first, and use that one, e.g.:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">detinfo::DetectorProperties <span class="directive">const</span>* detprop
  = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();
<span class="predefined-type">double</span> sampling_rate = detprop-&gt;SamplingRate();
</span></code></pre><br /><code>lar::providerFrom<></code> is defined in <code>larcore/CoreUtils/ServiceUtil.h</code>.<br />The first line can be also written as:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">detinfo::DetectorPropertiesService::provider_type <span class="directive">const</span>* detprop
  = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();
</span></code></pre><br />if you don't want to bother to learn the real provider name, or:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="directive">auto</span> <span class="directive">const</span>* detprop = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();
</span></code></pre><br />The service provider pointer should be obtained anew on each new event rather than saved in the module. In the module/algorithm factorization model, the algorithm should store the pointer and the module should update the algorithm pointer on each event.</p>


	<blockquote>
		<p>Important: you will <strong>not</strong> be able any more to access methods from the service: <code>art::ServiceHandle&lt;detinfo::DetectorPropertiesService&gt;()->Efield()</code> will <em>not</em> work.</p>
	</blockquote>


	<div class="contextual heading-3" title="Edit this section" id="section-3"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=3">Edit this section</a></div><a name="How-to-update-to-the-new-service-access-pattern"></a>
<h3 >How to update to the new service access pattern<a href="#How-to-update-to-the-new-service-access-pattern" class="wiki-anchor">&para;</a></h3>


	<p>As described above, you can't use the <em>art</em> services, nor their <code>ServiceHandle</code>, directly any more, as all the functionality has been moved one layer deeper, in the service providers.</p>


	<div class="contextual heading-4" title="Edit this section" id="section-4"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=4">Edit this section</a></div><a name="If-your-code-declares-and-uses-a-local-service-handle"></a>
<h4 >If your code declares and uses a <em>local service handle</em>...<a href="#If-your-code-declares-and-uses-a-local-service-handle" class="wiki-anchor">&para;</a></h4>


	<p>... a service provider needs to be used instead.<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">art::ServiceHandle&lt;util::DetectorProperties&gt; detprop;
<span class="predefined-type">double</span> sampling_rate = detprop-&gt;SamplingRate();
</span></code></pre><br />becomes:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="directive">auto</span> <span class="directive">const</span>* detprop = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();
<span class="predefined-type">double</span> sampling_rate = detprop-&gt;SamplingRate();
</span></code></pre><br />Note that the access looks the same (the second line in the example does not change), and only one header file is included (was <code>Utilities/DetectorProperties.h</code>, now is <code>DetectorInfoServices/DetectorPropertiesService.h</code>, see below).</p>


	<div class="contextual heading-4" title="Edit this section" id="section-5"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=5">Edit this section</a></div><a name="If-your-code-uses-a-service-pointer-or-reference"></a>
<h4 >If your code uses a <em>service pointer or reference</em>...<a href="#If-your-code-uses-a-service-pointer-or-reference" class="wiki-anchor">&para;</a></h4>


	<p>... a service provider needs to be used instead.<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">util::DetectorProperties const&#38; detprop = *art::ServiceHandle&lt;util::DetectorProperties&gt;();
<span class="predefined-type">double</span> sampling_rate = detprop.SamplingRate();
</span></code></pre><br />becomes:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="directive">auto</span> const&#38; detprop = *lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();
<span class="predefined-type">double</span> sampling_rate = detprop.SamplingRate();
</span></code></pre><br />This case is very similar to the previous one.</p>


	<div class="contextual heading-4" title="Edit this section" id="section-6"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=6">Edit this section</a></div><a name="If-your-algorithm-class-has-a-service-handle-member"></a>
<h4 >If your algorithm class has a <em>service handle</em> member...<a href="#If-your-algorithm-class-has-a-service-handle-member" class="wiki-anchor">&para;</a></h4>


	<p>... a service provider needs to be used instead.<br />You may have in your class declaration:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">  art::ServiceHandle&lt;util::DetectorProperties&gt; fDetProp;
</span></code></pre><br />and in your code:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">  <span class="predefined-type">double</span> sampling_rate = fDetProp-&gt;SamplingRate();
</span></code></pre></p>


	<p>This fix is more articulated.<br />The class declaration should host a provider pointer instead:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">  detinfo::DetectorProperties <span class="directive">const</span>* fDetProp = <span class="predefined-constant">nullptr</span>;
</span></code></pre><br />Note that here you need to include the <em>provider header</em> (<code>#include "DetectorInfo/DetectorProperties.h"</code>). And no <code>auto</code> option here, sorry.<br />That pointer needs to be initialized with a valid pointer to provider, for example in the <em>constructor</em> of your class (<code>MyAlg</code>):<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">MyAlg::MyAlg(fhicl::ParameterSet const&#38;)
  : fDetProp(lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;())
  <span class="comment">// ... the normal constructor follows</span>
</span></code></pre><br />and in this case the source file also needs to explicitly include the <em>service header</em> (<code>#include "DetectorInfoService/DetectorPropertiesService.h"</code>).<br />Or you can opt for other initialization methods, like a deferred set up function:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="directive">void</span> MyAlg::Setup(detinfo::DetectorProperties const&#38; detprop) {
  fDetProp = &amp;detprop;
} <span class="comment">// MyAlg::Setup()</span>
</span></code></pre><br />This approach puts an additional burden to the owner ofthe algorithm, that needs to fetch the provider and pass it to the algorithm, but it makes the algorithm <em>independent</em> of the framework (<em>art</em>) as the service is concerned.</p>


	<p>There are a couple of structures to make this a bit easier, especially if our algorithm uses many services and it needs to set up sub-algorithms.<br />See the <code>ProviderPack</code> section <a class="wiki-page" href="#The-ProviderPack-and-ServicePack-classes">below</a>.</p>


	<p>Finally, the user code:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="predefined-type">double</span> sampling_rate = fDetProp-&gt;SamplingRate();
</span></code></pre><br />remains the same.</p>


	<div class="contextual heading-2" title="Edit this section" id="section-7"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=7">Edit this section</a></div><a name="Renamed-services"></a>
<h2 >Renamed services<a href="#Renamed-services" class="wiki-anchor">&para;</a></h2>


	<table>
		<tr>
			<th>Old service                   </th>
			<th>New service                        </th>
			<th>I/F </th>
		</tr>
		<tr>
			<td> <code>geo::Geometry</code>                 </td>
			<td> <em>(unchanged)</em>                        </td>
			<td>       </td>
		</tr>
		<tr>
			<td> <code>util::DatabaseUtil</code>            </td>
			<td> <em>(deprecated except for ArgoNeuT)</em>   </td>
			<td>       </td>
		</tr>
		<tr>
			<td> <code>util::TimeService</code>             </td>
			<td> <code>detinfo::DetectorClocksService</code>     </td>
			<td>   I   </td>
		</tr>
		<tr>
			<td> <code>util::LArProperties</code>           </td>
			<td> <code>detinfo::LArPropertiesService</code>      </td>
			<td>   I   </td>
		</tr>
		<tr>
			<td> <code>util::DetectorProperties</code>      </td>
			<td> <code>detinfo::DetectorPropertiesService</code> </td>
			<td>   I   </td>
		</tr>
		<tr>
			<td> <code>lariov::IChannelStatusService</code> </td>
			<td> <code>lariov::ChannelStatusService</code>       </td>
			<td>   I   </td>
		</tr>
		<tr>
			<td> <code>lariov::IDetPedestalService</code>   </td>
			<td> <code>lariov::DetPedestalService</code>         </td>
			<td>   I   </td>
		</tr>
	</table>




	<p>The column "I/F" says "I" if the service is actually an interface. See the next section about service interfaces.<br />Expand the following reference tables for the details necessary for the update:</p>


	<p><a href="#" onclick="$(&#39;#collapse-3596967c-show, #collapse-3596967c-hide&#39;).toggle(); $(&#39;#collapse-3596967c&#39;).fadeToggle(150);; return false;" id="collapse-3596967c-show" class="collapsible collapsed">Geometry service (unchanged)</a><a href="#" onclick="$(&#39;#collapse-3596967c-show, #collapse-3596967c-hide&#39;).toggle(); $(&#39;#collapse-3596967c&#39;).fadeToggle(150);; return false;" id="collapse-3596967c-hide" class="collapsible" style="display:none;">Geometry service (unchanged)</a><div id="collapse-3596967c" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                       </th>
			<th>repo.   </th>
			<th><code>#include</code> path         </th>
		</tr>
		<tr>
			<th>Old service  name: </th>
			<td> <code>geo::Geometry</code>     </td>
			<td> <code>larcore</code> </td>
			<td> <code>Geometry/Geometry.h</code>     </td>
		</tr>
		<tr>
			<th>Old provider name: </th>
			<td> <code>geo::GeometryCore</code> </td>
			<td> <code>larcore</code> </td>
			<td> <code>Geometry/GeometryCore.h</code> </td>
		</tr>
		<tr>
			<th>Was interface:     </th>
			<td colspan="3">no                                                       </td>
		</tr>
		<tr>
			<th>New service  name: </th>
			<td colspan="3"><em>(unchanged)</em>                                            </td>
		</tr>
		<tr>
			<th>New provider name: </th>
			<td colspan="3"><em>(unchanged)</em>                                            </td>
		</tr>
	</table></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-420c4f5b-show, #collapse-420c4f5b-hide&#39;).toggle(); $(&#39;#collapse-420c4f5b&#39;).fadeToggle(150);; return false;" id="collapse-420c4f5b-show" class="collapsible collapsed">DatabaseUtil service (deprecated)</a><a href="#" onclick="$(&#39;#collapse-420c4f5b-show, #collapse-420c4f5b-hide&#39;).toggle(); $(&#39;#collapse-420c4f5b&#39;).fadeToggle(150);; return false;" id="collapse-420c4f5b-hide" class="collapsible" style="display:none;">DatabaseUtil service (deprecated)</a><div id="collapse-420c4f5b" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                        </th>
			<th>repo.   </th>
			<th><code>#include</code> path          </th>
		</tr>
		<tr>
			<th>Old service  name: </th>
			<td> <code>util::DatabaseUtil</code> </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DatabaseUtil.h</code> </td>
		</tr>
		<tr>
			<th>Old provider name: </th>
			<td colspan="3"><em>n/a</em>                                                      </td>
		</tr>
		<tr>
			<th>Was interface:     </th>
			<td colspan="3">no                                                         </td>
		</tr>
		<tr>
			<th>New service  name: </th>
			<td colspan="3"><em>(unchanged)</em>                                              </td>
		</tr>
		<tr>
			<th>New provider name: </th>
			<td colspan="3"><em>(unchanged)</em>                                              </td>
		</tr>
		<tr>
			<th>Is interface:      </th>
			<td colspan="3">no                                                         </td>
		</tr>
	</table>


	<blockquote>
		<p><code>DatabaseUtil</code> service is being deprecated for all experiments except ArgoNeuT. It provides direct access to databases, which has proven to be a non-scalable approach.<br />  MicroBooNE-specific components in there will be moved into a MicroBooNE-specific implementation.<br />  ArgoNeuT will possibly keep using it, so it is not going to disappear, but it might be moved into their repository.</p>
	</blockquote></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-b360e7cd-show, #collapse-b360e7cd-hide&#39;).toggle(); $(&#39;#collapse-b360e7cd&#39;).fadeToggle(150);; return false;" id="collapse-b360e7cd-show" class="collapsible collapsed">LArPropertiesService (was LArProperties)</a><a href="#" onclick="$(&#39;#collapse-b360e7cd-show, #collapse-b360e7cd-hide&#39;).toggle(); $(&#39;#collapse-b360e7cd&#39;).fadeToggle(150);; return false;" id="collapse-b360e7cd-hide" class="collapsible" style="display:none;">LArPropertiesService (was LArProperties)</a><div id="collapse-b360e7cd" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                                                </th>
			<th>repo.   </th>
			<th><code>#include</code> path                          </th>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>util::LArProperties</code>                   </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/LArProperties.h</code>                </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td colspan="3"><em>n/a</em>                                                                                         </td>
		</tr>
		<tr>
			<th>Was interface:          </th>
			<td colspan="3">no                                                                                            </td>
		</tr>
		<tr>
			<th>New service  name:      </th>
			<td> <code>detinfo::LArPropertiesService</code>         </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/LArPropertiesService.h</code>         </td>
		</tr>
		<tr>
			<th>New provider name:      </th>
			<td> <code>detinfo::LArProperties</code>                </td>
			<td> <code>lardata</code> </td>
			<td> <code>DataProviders/LArProperties.h</code>            </td>
		</tr>
		<tr>
			<th>Is interface:           </th>
			<td colspan="3">yes                                                                                           </td>
		</tr>
		<tr>
			<th>Default implementation: </th>
			<td> <code>detinfo::LArPropertiesServiceStandard</code> </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/LArPropertiesServiceStandard.h</code> </td>
		</tr>
	</table></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-f3473d8f-show, #collapse-f3473d8f-hide&#39;).toggle(); $(&#39;#collapse-f3473d8f&#39;).fadeToggle(150);; return false;" id="collapse-f3473d8f-show" class="collapsible collapsed">DetectorPropertiesService (was DetectorProperties)</a><a href="#" onclick="$(&#39;#collapse-f3473d8f-show, #collapse-f3473d8f-hide&#39;).toggle(); $(&#39;#collapse-f3473d8f&#39;).fadeToggle(150);; return false;" id="collapse-f3473d8f-hide" class="collapsible" style="display:none;">DetectorPropertiesService (was DetectorProperties)</a><div id="collapse-f3473d8f" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                                                      </th>
			<th>repo.   </th>
			<th><code>#include</code> path                               </th>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>util::DetectorProperties</code>                    </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DetectorProperties.h</code>                </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td colspan="3"><em>n/a</em>                                                                                                    </td>
		</tr>
		<tr>
			<th>Was interface:          </th>
			<td colspan="3">no                                                                                                       </td>
		</tr>
		<tr>
			<th>New service  name:      </th>
			<td> <code>detinfo::DetectorPropertiesService</code>          </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DetectorPropertiesService.h</code>         </td>
		</tr>
		<tr>
			<th>New provider name:      </th>
			<td> <code>detinfo::DetectorProperties</code>                 </td>
			<td> <code>lardata</code> </td>
			<td> <code>DataProviders/DetectorProperties.h</code>            </td>
		</tr>
		<tr>
			<th>Is interface:           </th>
			<td colspan="3">yes                                                                                                      </td>
		</tr>
		<tr>
			<th>Default implementation: </th>
			<td> <code>detinfo::DetectorPropertiesServiceStandard</code>  </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DetectorPropertiesServiceStandard.h</code> </td>
		</tr>
	</table></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-d4ff0b13-show, #collapse-d4ff0b13-hide&#39;).toggle(); $(&#39;#collapse-d4ff0b13&#39;).fadeToggle(150);; return false;" id="collapse-d4ff0b13-show" class="collapsible collapsed">DetectorClocksService (was TimeService)</a><a href="#" onclick="$(&#39;#collapse-d4ff0b13-show, #collapse-d4ff0b13-hide&#39;).toggle(); $(&#39;#collapse-d4ff0b13&#39;).fadeToggle(150);; return false;" id="collapse-d4ff0b13-hide" class="collapsible" style="display:none;">DetectorClocksService (was TimeService)</a><div id="collapse-d4ff0b13" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                                                 </th>
			<th>repo.   </th>
			<th><code>#include</code> path                            </th>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>util::TimeService</code>                      </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/TimeService.h</code>                    </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td> <code>util::SimpleTimeService</code>                </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/SimpleTimeService.h</code>              </td>
		</tr>
		<tr>
			<th>Was interface:          </th>
			<td colspan="3">no                                                                                               </td>
		</tr>
		<tr>
			<th>New service  name:      </th>
			<td> <code>detinfo::DetectorClocksService</code>         </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DetectorClocksService.h</code>          </td>
		</tr>
		<tr>
			<th>New provider name:      </th>
			<td> <code>detinfo::DetectorClocks</code>                </td>
			<td> <code>lardata</code> </td>
			<td> <code>DataProviders/DetectorClocks.h</code>             </td>
		</tr>
		<tr>
			<th>Is interface:           </th>
			<td colspan="3">yes                                                                                              </td>
		</tr>
		<tr>
			<th>Default implementation: </th>
			<td> <code>detinfo::DetectorClocksServiceStandard</code> </td>
			<td> <code>lardata</code> </td>
			<td> <code>Utilities/DetectorClocksServiceStandard.h</code>  </td>
		</tr>
	</table></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-f1b5e266-show, #collapse-f1b5e266-hide&#39;).toggle(); $(&#39;#collapse-f1b5e266&#39;).fadeToggle(150);; return false;" id="collapse-f1b5e266-show" class="collapsible collapsed">ChannelStatusService (was IChannelStatusService)</a><a href="#" onclick="$(&#39;#collapse-f1b5e266-show, #collapse-f1b5e266-hide&#39;).toggle(); $(&#39;#collapse-f1b5e266&#39;).fadeToggle(150);; return false;" id="collapse-f1b5e266-hide" class="collapsible" style="display:none;">ChannelStatusService (was IChannelStatusService)</a><div id="collapse-f1b5e266" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                                                 </th>
			<th>repo.  </th>
			<th><code>#include</code> path                            </th>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>lariov::IChannelStatusService</code>          </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/IChannelStatusService.h</code>                    </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td> <code>lariov::IChannelStatusProvider</code>         </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/IChannelStatusProvider.h</code>              </td>
		</tr>
		<tr>
			<th>Was interface:          </th>
			<td colspan="3">yes                                                                                              </td>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>lariov::ChannelStatusService</code>           </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/ChannelStatusService.h</code>                     </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td> <code>lariov::ChannelStatusProvider</code>          </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/ChannelStatusProvider.h</code>               </td>
		</tr>
		<tr>
			<th>Is interface:           </th>
			<td colspan="3">yes                                                                                              </td>
		</tr>
		<tr>
			<th>Default implementation: </th>
			<td> <code>lariov::SIOVChannelStatusService</code> </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Services/SIOVChannelStatusService.cc</code>  </td>
		</tr>
	</table>


	<pre><code>Note that there is no header for the "standard" implementation of the art service (there is one for the provider).</code></pre></div></p>


	<p><a href="#" onclick="$(&#39;#collapse-8d5afeda-show, #collapse-8d5afeda-hide&#39;).toggle(); $(&#39;#collapse-8d5afeda&#39;).fadeToggle(150);; return false;" id="collapse-8d5afeda-show" class="collapsible collapsed">DetPedestalService (was IDetPedestalService)</a><a href="#" onclick="$(&#39;#collapse-8d5afeda-show, #collapse-8d5afeda-hide&#39;).toggle(); $(&#39;#collapse-8d5afeda&#39;).fadeToggle(150);; return false;" id="collapse-8d5afeda-hide" class="collapsible" style="display:none;">DetPedestalService (was IDetPedestalService)</a><div id="collapse-8d5afeda" class="collapsed-text" style="display:none;"><table>
		<tr>
			<th colspan="2">                                                               </th>
			<th>repo.  </th>
			<th><code>#include</code> path                            </th>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>lariov::IDetPedestalService</code>          </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/IDetPedestalService.h</code>                    </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td> <code>lariov::IDetPedestalProvider</code>         </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/IDetPedestalProvider.h</code>              </td>
		</tr>
		<tr>
			<th>Was interface:          </th>
			<td colspan="3">yes                                                                                              </td>
		</tr>
		<tr>
			<th>Old service  name:      </th>
			<td> <code>lariov::DetPedestalService</code>           </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/DetPedestalService.h</code>                     </td>
		</tr>
		<tr>
			<th>Old provider name:      </th>
			<td> <code>lariov::DetPedestalProvider</code>          </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Interface/DetPedestalProvider.h</code>               </td>
		</tr>
		<tr>
			<th>Is interface:           </th>
			<td colspan="3">yes                                                                                              </td>
		</tr>
		<tr>
			<th>Default implementation: </th>
			<td> <code>lariov::SIOVDetPedestalService</code> </td>
			<td> <code>larevt</code> </td>
			<td> <code>CalibrationDBI/Services/SIOVDetPedestalService.cc</code>  </td>
		</tr>
	</table>


	<pre><code>Note that there is no header for the "standard" implementation of the art service (there is one for the provider).</code></pre></div></p>


	<div class="contextual heading-3" title="Edit this section" id="section-8"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=8">Edit this section</a></div><a name="Examples-of-update-DetectorProperties-service"></a>
<h3 >Examples of update: <code>DetectorProperties</code> service<a href="#Examples-of-update-DetectorProperties-service" class="wiki-anchor">&para;</a></h3>


	<p>The first visible issue is that compilation fails for a missing header <code>Utilities/DetectorProperties.h</code>.</p>


Changes:
	<ul>
	<li><code>CMakeLists.txt</code>:
	<ul>
	<li>remove <code>DetectorProperties_service</code>[1]</li>
	</ul>
	</li>
		<li>header inclusion (the optional headers are pulled in anyway, but their explicit mention makes the code more readable):
	<ul>
	<li><code>#include "Utilities/DetectorProperties.h"</code> -> <code>#include "Utilities/DetectorPropertiesService.h"</code></li>
		<li><em>(optional)</em> add <code>#include "DataProviders/DetectorProperties.h"</code></li>
		<li><em>(optional)</em> add <code>#include "CoreUtils/ServiceUtil.h" // lar::providerFrom<>()</code></li>
	</ul>
	</li>
		<li><code>art::ServiceHandle&lt;util::DetectorProperties&gt; detprop;</code> -> <code>detinfo::DetectorProperties const* detprop = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();</code><br />  (or <code>auto const* detprop = lar::providerFrom&lt;detinfo::DetectorPropertiesService&gt;();</code>)</li>
		<li>FHiCL configuration:
	<ul>
	<li><code>DetectorProperties:</code> -> <code>DetectorPropertiesService:</code> either within a <code>services</code> parameter set or <code>services.</code> stand-alone line (note: no <code>user</code> section should appear)</li>
		<li>add <code>service_provider: DetectorPropertiesServiceStandard</code> (or the implementation of your choice) in the <code>DetectorPropertiesService</code> parameter set</li>
	</ul></li>
	</ul>


	<p id="fn1" class="footnote"><sup>1</sup> Because the service has become an interface, and the interface itself is pure abstract, service library contains no code. The actual code will be loaded and linked by the framework at run time.</p>


	<div class="contextual heading-3" title="Edit this section" id="section-9"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=9">Edit this section</a></div><a name="Examples-of-update-TimeService-service"></a>
<h3 >Examples of update: <code>TimeService</code> service<a href="#Examples-of-update-TimeService-service" class="wiki-anchor">&para;</a></h3>


	<p>The first visible issue is that compilation fails for a missing header <code>Utilities/TimeService.h</code>.</p>


Changes:
	<ul>
	<li><code>CMakeLists.txt</code>:
	<ul>
	<li>remove <code>TimeService_service</code>[1]</li>
	</ul>
	</li>
		<li>header inclusion (the optional headers are pulled in anyway, but their explicit mention makes the code more readable):
	<ul>
	<li><code>#include "Utilities/TimeService.h"</code> -> <code>#include "Utilities/DetectorClocksService.h"</code></li>
		<li><em>(optional)</em> add <code>#include "DataProviders/DetectorClocks.h"</code></li>
		<li><em>(optional)</em> add <code>#include "CoreUtils/ServiceUtil.h" // lar::providerFrom<>()</code></li>
	</ul>
	</li>
		<li><code>art::ServiceHandle&lt;util::TimeService&gt; detprop;</code> -> <code>detinfo::DetectorClocks const* detprop = lar::providerFrom&lt;detinfo::DetectorClocksService&gt;();</code><br />  (or <code>auto const* detprop = lar::providerFrom&lt;detinfo::DetectorClocksService&gt;();</code>)</li>
		<li>FHiCL configuration:
	<ul>
	<li><code>TimeService:</code> -> <code>DetectorClocksService:</code> either within a <code>services</code> parameter set or <code>services.</code> stand-alone line (note: no <code>user</code> section should appear)</li>
		<li>add <code>service_provider: DetectorClocksServiceStandard</code> (or the implementation of your choice) in the <code>DetectorClocksService</code> parameter set</li>
	</ul></li>
	</ul>


	<p id="fn1" class="footnote"><sup>1</sup> Because the service has become an interface, and the interface itself is pure abstract, service library contains no code. The actual code will be loaded and linked by the framework at run time.</p>


	<div class="contextual heading-3" title="Edit this section" id="section-10"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=10">Edit this section</a></div><a name="Examples-of-update-Geometry-service"></a>
<h3 >Examples of update: <code>Geometry</code> service<a href="#Examples-of-update-Geometry-service" class="wiki-anchor">&para;</a></h3>


	<p>The changes are backward-compatible, but future changes might break the "legacy" compatibility.</p>


Changes:
	<ul>
	<li>header inclusion (the optional headers are pulled in anyway, but their explicit mention makes the code more readable):
	<ul>
	<li><code>#include "Geometry/Geometry.h"</code> (should be there already...)</li>
		<li><em>(optional)</em> add <code>#include "Geometry/GeometryCore.h"</code></li>
		<li><em>(optional)</em> add <code>#include "#include "CoreUtils/ServiceUtil.h" // lar::providerFrom<>()</code></li>
	</ul>
	</li>
		<li><code>art::ServiceHandle&lt;geo::Geometry&gt; geom;</code> -> <code>geo::GeometryCore const* geom = lar::providerFrom&lt;geo::Geometry&gt;();</code><br />  (or <code>auto const* geom = lar::providerFrom&lt;geo::Geometry&gt;();</code>)</li>
	</ul>


	<div class="contextual heading-3" title="Edit this section" id="section-11"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=11">Edit this section</a></div><a name="Additional-steps-for-updating-DetectorPropertiesService-and-LArPropertiesService"></a>
<h3 >Additional steps for updating <code>DetectorPropertiesService</code> and <code>LArPropertiesService</code><a href="#Additional-steps-for-updating-DetectorPropertiesService-and-LArPropertiesService" class="wiki-anchor">&para;</a></h3>


	<p>Some parameters have been moved from <code>LArProperties</code> to <code>DetectorPropertiesService</code> (rather than <code>LArPropertiesService</code>) (see <a class="wiki-page" href="#Functions-and-configuration-parameters-moved-from-one-service-to-another">the table below</a>).<br />If you are defining or overriding those parameters in your FHiCL file, you have to fix the definition to happen in the right parameter set, by replacing <code>LArProperties.</code> with <code>DetectorPropertiesService.</code> the path (in case of overriding) or by moving the line to the right service configuration (in case of complete definition of the service parameters).</p>


	<div class="contextual heading-2" title="Edit this section" id="section-12"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=12">Edit this section</a></div><a name="Core-service-dependencies"></a>
<h2 >Core service dependencies<a href="#Core-service-dependencies" class="wiki-anchor">&para;</a></h2>


	<p>Some dependencies have changed. In particular, note the dropping of <code>DatabaseUtil</code> from the dependencies; <code>DatabaseUtil</code> is being now considered ArgoNeuT-specific.</p>


	<table>
		<tr>
			<th>Service                                    </th>
			<th>depends on                                                </th>
		</tr>
		<tr>
			<td> <code>geo::Geometry</code>                              </td>
			<td> <code>geo::ExptGeometryHelperInterface</code>                          </td>
		</tr>
		<tr>
			<td> <code>util::DatabaseUtil</code>                         </td>
			<td> <em>none</em> (and: <em>deprecated</em>)                                  </td>
		</tr>
		<tr>
			<td> <code>detinfo::DetectorClocksServiceStandard</code>     </td>
			<td> <em>none</em>                                                      </td>
		</tr>
		<tr>
			<td> <code>detinfo::LArPropertiesServiceStandard</code>      </td>
			<td> <em>none</em>                                                      </td>
		</tr>
		<tr>
			<td> <code>detinfo::DetectorPropertiesServiceStandard</code> </td>
			<td> <code>geo::Geometry</code>, <code>detinfo::LArPropertiesService</code>, <code>detinfo::DetectorClocksService</code> </td>
		</tr>
	</table>




	<div class="contextual heading-2" title="Edit this section" id="section-13"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=13">Edit this section</a></div><a name="Core-services-turned-into-service-interfaces"></a>
<h2 >Core services turned into service interfaces<a href="#Core-services-turned-into-service-interfaces" class="wiki-anchor">&para;</a></h2>


	<p>To use a services marked as interface, the job FHiCL configuration must contain for it the specific implementation that is requested, by a <code>service_provider: ImplementationName</code> parameter.<br />The following table shows implementations provided within LArSoft:</p>


	<table>
		<tr>
			<th>Service                      </th>
			<th colspan="2">Default/other implementations                            </th>
		</tr>
		<tr>
			<td> <code>DetectorClocksService</code>        </td>
			<td> <code>DetectorClocksServiceStandard</code> (<code>lardata</code>)     </td>
			<td> <em>standard</em> </td>
		</tr>
		<tr>
			<td rowspan="2"><code>LArPropertiesService</code>      </td>
			<td> <code>LArPropertiesServiceStandard</code> (<code>lardata</code>)      </td>
			<td> <em>standard</em> </td>
		</tr>
		<tr>
			<td>                                  <code>LArPropertiesServiceArgoNeuT</code> (<code>lardata</code>)      </td>
			<td> legacy, for ArgoNeuT; depends on <code>DatabaseUtil</code> </td>
		</tr>
		<tr>
			<td rowspan="2"><code>DetectorPropertiesService</code> </td>
			<td> <code>DetectorPropertiesServiceStandard</code> (<code>lardata</code>) </td>
			<td> <em>standard</em> </td>
		</tr>
		<tr>
			<td>                                  <code>DetectorPropertiesServiceArgoNeuT</code> (<code>lardata</code>) </td>
			<td> legacy, for ArgoNeuT; depends on <code>LArPropertiesServiceArgoNeuT</code> </td>
		</tr>
	</table>




	<div class="contextual heading-2" title="Edit this section" id="section-14"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=14">Edit this section</a></div><a name="New-namespaces"></a>
<h2 >New namespaces<a href="#New-namespaces" class="wiki-anchor">&para;</a></h2>


	<p>The current organization of namespaces is:</p>


	<table>
		<tr>
			<td> <code>detinfo</code> </td>
			<td> service interfaces for the core services in <code>lardata</code>                          </td>
		</tr>
		<tr>
			<td> <code>detinfo</code> </td>
			<td> "standard" service implementations for the core services in <code>lardata</code>          </td>
		</tr>
		<tr>
			<td> <code>detinfo</code> </td>
			<td> service provider interfaces for the core services in <code>lardata</code>                 </td>
		</tr>
		<tr>
			<td> <code>detinfo</code> </td>
			<td> "standard" service provider implementations for the core services in <code>lardata</code> </td>
		</tr>
	</table>




	<p>(also called "shove everything into <code>detinfo</code>")</p>


	<div class="contextual heading-2" title="Edit this section" id="section-15"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=15">Edit this section</a></div><a name="Functions-and-configuration-parameters-moved-from-one-service-to-another"></a>
<h2 >Functions and configuration parameters moved from one service to another<a href="#Functions-and-configuration-parameters-moved-from-one-service-to-another" class="wiki-anchor">&para;</a></h2>


	<table>
		<tr>
			<th>Function               </th>
			<th>Old service         </th>
			<th>New service               </th>
			<th>New name         </th>
			<th>FHiCL parameter name </th>
		</tr>
		<tr>
			<td> <code>DriftVelocity</code> <em>(all)</em>  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <em>none</em>                 </td>
		</tr>
		<tr>
			<td> <code>Efield</code>                 </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>Efield</code>               </td>
		</tr>
		<tr>
			<td> <code>ElectronLifetime()</code>     </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>Electronlifetime</code>     </td>
		</tr>
		<tr>
			<td> <code>BirksCorrection()</code>      </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>Electronlifetime</code>     </td>
		</tr>
		<tr>
			<td> <code>ModBoxCorrection()</code>     </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>Electronlifetime</code>     </td>
		</tr>
		<tr>
			<td> <code>Temperature()</code>          </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>Temperature</code>          </td>
		</tr>
		<tr>
			<td> <em>(n/a)</em>                  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>SternheimerA</code>         </td>
		</tr>
		<tr>
			<td> <em>(n/a)</em>                  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>SternheimerK</code>         </td>
		</tr>
		<tr>
			<td> <em>(n/a)</em>                  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>SternheimerX0</code>        </td>
		</tr>
		<tr>
			<td> <em>(n/a)</em>                  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>SternheimerX1</code>        </td>
		</tr>
		<tr>
			<td> <em>(n/a)</em>                  </td>
			<td> <code>LArProperties</code>       </td>
			<td> <code>DetectorPropertiesService</code> </td>
			<td> <em>(unchanged)</em>      </td>
			<td> <code>SternheimerCbar</code>      </td>
		</tr>
	</table>




	<div class="contextual heading-3" title="Edit this section" id="section-16"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=16">Edit this section</a></div><a name="FHiCL-parameter-validation-for-detutilLArPropertiesStandard-and-detutilDetectorPropertiesStandard"></a>
<h3 >FHiCL parameter validation for <code>detutil::LArPropertiesStandard</code> and <code>detutil::DetectorPropertiesStandard</code><a href="#FHiCL-parameter-validation-for-detutilLArPropertiesStandard-and-detutilDetectorPropertiesStandard" class="wiki-anchor">&para;</a></h3>


	<p>The new standard implementation of <code>detutil::LArProperties</code> and <code>detutil::DetectorProperties</code> use a feature of FHiCL C++ library, that allows documentation and validation of the configuration parameters.</p>


	<p><em>Documentation</em> means that with <code>lar --service-description LArPropertiesServiceStandard</code> you get an example FHiCL file to configure, in fact, <code>detinfo::LArPropertiesServiceStandard</code>. Cool.</p>


	<p><em>Validation</em> means that now if you have in your configuration a parameter that is not supported, you'll get a run-time error.<br />That is typically because of mistyping; but in this case it may also be that, e.g., you still have <code>Efield</code> in <code>LArPropertiesServiceStandard</code> configuration, while it should have been moved into <code>DetectorPropertiesServiceStandard</code> configuration.</p>


	<p>This exciting new feature is documented in <a href="https://cdcvs.fnal.gov/redmine/projects/art/wiki/Configuration_validation_and_description" class="external">FHiCL wiki documentation</a>, and we encourage everybody to use it for algorithms as well. Also note that the validation does not depend on <em>art</em> (in fact, our service providers do use it).</p>


	<div class="contextual heading-2" title="Edit this section" id="section-17"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=17">Edit this section</a></div><a name="Summary-of-update-steps"></a>
<h2 >Summary of update steps<a href="#Summary-of-update-steps" class="wiki-anchor">&para;</a></h2>


	<ul>
	<li>"automatic" changes (compiler error if skipped):<br />  - rename the service names and name spaces in source code<br />  - rename the service names in FHiCL files<br />  - rename the directories in the include paths<br />  - remove linking to the special services</li>
		<li>non-automatic changes (compiler error if skipped):<br />  - replace the use of art services with service providers<br />  - update which service to ask for the functions that have been moved to a different service</li>
		<li>non-automatic changes (runtime error if skipped):<br />  - add <code>service_provider</code> to service FHiCL configuration (if not inherited)</li>
	</ul>


	<div class="contextual heading-3" title="Edit this section" id="section-18"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=18">Edit this section</a></div><a name="Helper-script"></a>
<h3 >Helper script<a href="#Helper-script" class="wiki-anchor">&para;</a></h3>


	<p>As the previous paragraph also states, you are provided no tool for automatic conversion; but almost.<br />It is now provided in <code>larsoft</code> repository: <code>${LARSOFT_DIR}/bin/UpdateCoreServices.py</code> (you can copy it, but note that it needs its <code>SerialSubstitution.py</code> to be available, e.g., in the same directory).<br />To get a list of supported options run <code>UpdateCoreServices.py --help</code>.<br />In the end, these are not extremely sophisticated. You run the script with:<br /><pre>
./UpdateCoreServices.py --verbose --color "${MRB_SOURCE}/my_package" 
</pre><br />and you get a long list of messages describing what is changing.<br /><em>Most</em> of the changes are ok. But pay special attention to <code>CMakeLists.txt</code> files and to class code.<br />If you have a class member of type art::ServiceHandle<>, the script will probably change the code in a way you don't want.<br />Also, <em>do pay attention to warnings</em>: they usually show a pattern that needs to be updated, and the script misses some information that would allow an automatic fix. So: you fix it by hand.<br />You can process file by file or directory by directory if you want to be selective.</p>


When you think it's time to give it a try:
	<ol>
	<li>make sure you have committed your local changes!! <code>git</code> will let you revert if something goes bad</li>
		<li>run the same command as above but add with <code>--doit</code> option</li>
		<li>fire up <code>git diff</code> to see what happened, try to understand each change</li>
		<li>recompile and test</li>
		<li>run the script (without <code>--doit</code>) again, and consider what's left (including the warnings, that won't go away)</li>
	</ol>


	<blockquote>
		<p>If you are lost or need help, <em>please contact the LArSoft team</em> (e.g. send an e-mail to <code>larsoft@fnal.gov</code> or open a redmine support ticket).</p>
	</blockquote>


	<div class="contextual heading-2" title="Edit this section" id="section-19"><a class="icon-only icon-edit" href="/redmine/projects/larsoft/wiki/Core_Services_Review/edit?section=19">Edit this section</a></div><a name="The-ProviderPack-and-ServicePack-classes"></a>
<h2 >The <code>ProviderPack</code> and <code>ServicePack</code> classes<a href="#The-ProviderPack-and-ServicePack-classes" class="wiki-anchor">&para;</a></h2>


	<p>If your algorithm needs multiple providers, it may be more convenient to define all of them in a structure.<br />Actually, first think: if it's just a single value that is needed, it's better to pass just that value (e.g., the electric field).<br />But if services are extensively used:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="comment">/// Type containing all the service providers we need</span>
<span class="directive">using</span> providers_t = lar::ProviderPack&lt;geo::GeometryCore, detinfo::LArProperties&gt;;

providers_t providers;

<span class="directive">void</span> Setup(providers_t new_providers) { providers = new_providers; }
</span></code></pre><br />With this approach, to use the service provider in your code you would do something like:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay"><span class="directive">auto</span> nCryo = providers.get&lt;geo::GeomeryCore&gt;()-&gt;Ncryostats();
</span></code></pre></p>


	<p>One advantage is that if your algorithm calls sub-algorithms that also use provider packs, you can write:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">MyAlgo algo;
algo.Setup(providers);
</span></code></pre><br />and let the compiler figure out which ones are needed (<code>MyAlgo</code> does not need to use all the providers in <code>providers</code>, either).</p>


	<p>Another advantage is that the <em>art</em> module that owns and initializes the algorithm can also take some shortcut:<br /><pre><code class="cpp syntaxhl"><span class="CodeRay">MyAlgo algo;
algo.Setup(lar::extractProviders&lt;geo::Geometry, detinfo::LArPropertiesService&gt;());
</span></code></pre></p>


	<p>All this is mostly typing convenience, since all is coded to be statically resolved, that is not to have run-time cost.</p>


	<p><code>ProviderPack</code> is currently declared in <code>lardata/DetectorInfo/ProviderPack.h</code>, while <code>ServicePack</code> is currently declared in <code>lardata/DetectorInfoServices/ServicePack.h</code>. They are pure templates, so there is no additional link-time dependency.</p>


<hr />


	<p><em>Last update: March 9, 2016 (<a class="email" href="mailto:petrillo@fnal.gov">petrillo@fnal.gov</a>)</em></p>
</div>


<fieldset class="collapsible collapsed hide-when-print">
  <legend onclick="toggleFieldset(this);">Files (0)</legend>
  <div style="display: none;">

  
  
  <div id="wiki_add_attachment">
    <form id="add_attachment_form" enctype="multipart/form-data" action="/redmine/projects/larsoft/wiki/Core_Services_Review/add_attachment" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="+9VJJMZWRCLHMBx/G5eX+zl7h4hE4w14T2iWeRi/1AMRO625Rsu4VN5H86bResPsUCJcfN8XzDw2pLgiEkqLtw==" />
      <div class="box">
      <p>
<span class="attachments_form">
  <span class="attachments_fields">
  </span>
  <span class="add_attachment" style="">
    <input type="file" name="attachments[dummy][file]" class="file_selector filedrop" multiple="multiple" onchange="addInputFiles(this);" data-max-file-size="419430400" data-max-file-size-message="This file cannot be uploaded because it exceeds the maximum allowed file size (400 MB)" data-max-concurrent-uploads="2" data-upload-path="/redmine/uploads.js" data-param="attachments" data-description="true" data-description-placeholder="Optional description" />
    (Maximum size: 400 MB)
  </span>
</span>

</p>
      </div>
      <input type="submit" name="commit" value="Add" />
</form>  </div>
</div>
</fieldset>

<p class="other-formats">Also available in:  <span><a class="pdf" rel="nofollow" href="/redmine/projects/larsoft/wiki/Core_Services_Review.pdf">PDF</a></span>
  <span><a class="html" rel="nofollow" href="/redmine/projects/larsoft/wiki/Core_Services_Review.html">HTML</a></span>
  <span><a class="txt" rel="nofollow" href="/redmine/projects/larsoft/wiki/Core_Services_Review.txt">TXT</a></span>
</p>


        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2019 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
